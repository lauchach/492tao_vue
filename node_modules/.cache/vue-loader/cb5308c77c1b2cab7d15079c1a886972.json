{"remainingRequest":"/Users/lauchach/Desktop/CPE492webEdit/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lauchach/Desktop/CPE492webEdit/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lauchach/Desktop/CPE492webEdit/src/components/Login.vue","mtime":1637491403009},{"path":"/Users/lauchach/Desktop/CPE492webEdit/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lauchach/Desktop/CPE492webEdit/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lauchach/Desktop/CPE492webEdit/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lauchach/Desktop/CPE492webEdit/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZiIH0gZnJvbSAnLi4vZmlyZWJhc2UnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTG9naW4nLAogIHByb3BzOiB7CiAgICBtc2c6IFN0cmluZwogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiAnJywKICAgICAgZW1haWw6ICcnLAogICAgICBwYXNzd29yZDogJycKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxvZ2luICgpIHsKICAgICAgbGV0IF9kYXRhID0ge30KICAgICAgZmIuYXV0aCgpLnNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKHRoaXMuZW1haWwsIHRoaXMucGFzc3dvcmQpCiAgICAgICAgLnRoZW4oKGVtYWlsKSA9PiB7CiAgICAgICAgICBjb25zdCBkYiA9IGZiLmZpcmVzdG9yZSgpCiAgICAgICAgICBkYi5jb2xsZWN0aW9uKCdNRU1CRVJfVEFCTEUnKS53aGVyZSgnc3R1ZGVudF9tYWlsJywgJz09JywgdGhpcy5lbWFpbCkuZ2V0KCkudGhlbih1c2VyU2hvdyA9PiB7CiAgICAgICAgICAgIHVzZXJTaG93LmZvckVhY2goZG9jID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkb2MuaWQsICc9PicsIGRvYy5kYXRhKCkpCiAgICAgICAgICAgICAgX2RhdGEgPSBkb2MuZGF0YSgpCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyRGF0YScsIEpTT04uc3RyaW5naWZ5KF9kYXRhKSkKICAgICAgICAgICAgbGV0IHJlcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJEYXRhJykpCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdXRoIHBhc3MgcmVzJywgcmVzKQogICAgICAgICAgICBpZiAocmVzLnR5cGUpIHsKICAgICAgICAgICAgICBpZiAocmVzLnR5cGUgPT09ICdhZG1pbicpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCdhZG1pbicpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMudHlwZSA9PT0gJ3VzZXInIHx8IHJlcy50eXBlID09PSAnc3R1ZGVudCcpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCc4NT4+JykKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCdQcm9maWxldmlld3MnKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhbGVydCgn4Lih4Li14Lia4Liy4LiH4Lit4Lii4LmI4Liy4LiH4Lic4Li04LiU4Lie4Lil4Liy4LiUIOC4geC4o+C4uOC4k+C4suC4peC4reC4h+C5g+C4q+C4oeC5iOC4reC4teC4geC4hOC4o+C4seC5ieC4hycpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAvLyBIYW5kbGUgRXJyb3JzIGhlcmUuCiAgICAgICAgICB2YXIgZXJyb3JDb2RlID0gZXJyb3IuY29kZQogICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UKICAgICAgICAgIGlmIChlcnJvckNvZGUgPT09ICdhdXRoL3dyb25nLXBhc3N3b3JkJykgewogICAgICAgICAgICBhbGVydCgnV3JvbmcgcGFzc3dvcmQuJykKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsZXJ0KGVycm9yTWVzc2FnZSkKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0pCiAgICB9LAogICAgcmVnaXN0ZXIgKCkgewogICAgICBmYi5hdXRoKCkuY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKHRoaXMuZW1haWwsIHRoaXMucGFzc3dvcmQpCiAgICAgICAgLnRoZW4oKGVtYWlsKSA9PiB7CiAgICAgICAgICBjb25zdCBkYiA9IGZiLmZpcmVzdG9yZSgpCiAgICAgICAgICBkYi5jb2xsZWN0aW9uKCdNRU1CRVJfVEFCTEUnKS5kb2ModGhpcy5lbWFpbCkuc2V0KHsKICAgICAgICAgICAgc3R1ZGVudF9tYWlsOiB0aGlzLmVtYWlsLAogICAgICAgICAgICB0eXBlOiAndXNlcicsCiAgICAgICAgICAgIHN0YXR1czogMAogICAgICAgICAgfSkKICAgICAgICAgIGNvbnNvbGUubG9nKCfguJfguLNhZGQgZGInKQogICAgICAgICAgYWxlcnQoJ+C4quC4s+C5gOC4o+C5h+C4iCcpCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgLy8gSGFuZGxlIEVycm9ycyBoZXJlLgogICAgICAgICAgdmFyIGVycm9yQ29kZSA9IGVycm9yLmNvZGUKICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlCiAgICAgICAgICBpZiAoZXJyb3JDb2RlID09PSAnYXV0aC93ZWFrLXBhc3N3b3JkJykgewogICAgICAgICAgICBhbGVydCgnVGhlIHBhc3N3b3JkIGlzIHRvbyB3ZWFrLicpCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGVydChlcnJvck1lc3NhZ2UpCiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"login\">\n        <!-- Modal -->\n        <div class=\"modal fade\" id=\"login\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"loginTitle\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-dialog-centered\"  role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-body\">\n                        <ul class=\"nav nav-fill nav-pills mb-5\" id=\"pills-tab\" role=\"tablist\">\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link active\" id=\"pills-home-tab\" data-toggle=\"pill\" href=\"#pills-login\" role=\"tab\" aria-controls=\"pills-login\" aria-selected=\"true\">Login</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" id=\"pills-register-tab\" data-toggle=\"pill\" href=\"#pills-register\" role=\"tab\" aria-controls=\"pills-register\" aria-selected=\"false\">Signup</a>\n                            </li>\n                        </ul>\n                        <div class=\"tab-content\" id=\"pills-tabContent\">\n                        <div class=\"tab-pane fade show active\" id=\"pills-login\" role=\"tabpanel\" aria-labelledby=\"pills-login-tab\">\n                            <h5 class=\"text-center\">Login Please</h5>\n                            <div class=\"form-group\">\n                                <label for=\"exampleInputEmail1\">Email address</label>\n                                <input type=\"email\" v-model=\"email\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\">\n                                <small class=\"form-text text-muted\">We'll never share your email with anyone else.</small>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"exampleInputPassword1\">Password</label>\n                                <input type=\"password\" @keyup.enter=\"login\" v-model=\"password\" class=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Password\">\n                            </div>\n                            <div class=\"form-group\">\n                                <button class=\"btn btn-primary\" data-dismiss=\"modal\" @click=\"login\">Login</button>\n                            </div>\n                        </div>\n                        <div class=\"tab-pane fade\" id=\"pills-register\" role=\"tabpanel\" aria-labelledby=\"pills-register-tab\">\n                             <h5 class=\"text-center\">Create New Account</h5>\n                            <div class=\"form-group\">\n                                <label for=\"email\">Email address</label>\n                                <input type=\"email\"  v-model=\"email\" class=\"form-control\" id=\"email\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"password\">Password</label>\n                                <input type=\"password\" v-model=\"password\" class=\"form-control\" id=\"password\" placeholder=\"Password\">\n                            </div>\n                            <div class=\"form-group\">\n                                <button class=\"btn btn-primary\" data-dismiss=\"modal\"  @click=\"register\">Signup</button>\n                            </div>\n                        </div>\n                        </div>\n                </div>\n            </div>\n        </div>\n        </div>\n  </div>\n</template>\n<script>\nimport { fb } from '../firebase'\nexport default {\n  name: 'Login',\n  props: {\n    msg: String\n  },\n  data () {\n    return {\n      name: '',\n      email: '',\n      password: ''\n    }\n  },\n  methods: {\n    login () {\n      let _data = {}\n      fb.auth().signInWithEmailAndPassword(this.email, this.password)\n        .then((email) => {\n          const db = fb.firestore()\n          db.collection('MEMBER_TABLE').where('student_mail', '==', this.email).get().then(userShow => {\n            userShow.forEach(doc => {\n              console.log(doc.id, '=>', doc.data())\n              _data = doc.data()\n            })\n            localStorage.setItem('userData', JSON.stringify(_data))\n            let res = JSON.parse(localStorage.getItem('userData'))\n            console.log('auth pass res', res)\n            if (res.type) {\n              if (res.type === 'admin') {\n                this.$router.replace('admin')\n              } else if (res.type === 'user' || res.type === 'student') {\n                console.log('85>>')\n                this.$router.replace('Profileviews')\n              }\n            } else {\n              alert('มีบางอย่างผิดพลาด กรุณาลองใหม่อีกครั้ง')\n            }\n          })\n        })\n        .catch(function (error) {\n          // Handle Errors here.\n          var errorCode = error.code\n          var errorMessage = error.message\n          if (errorCode === 'auth/wrong-password') {\n            alert('Wrong password.')\n          } else {\n            alert(errorMessage)\n          }\n          console.log(error)\n        })\n    },\n    register () {\n      fb.auth().createUserWithEmailAndPassword(this.email, this.password)\n        .then((email) => {\n          const db = fb.firestore()\n          db.collection('MEMBER_TABLE').doc(this.email).set({\n            student_mail: this.email,\n            type: 'user',\n            status: 0\n          })\n          console.log('ทำadd db')\n          alert('สำเร็จ')\n        })\n        .catch(function (error) {\n        // Handle Errors here.\n          var errorCode = error.code\n          var errorMessage = error.message\n          if (errorCode === 'auth/weak-password') {\n            alert('The password is too weak.')\n          } else {\n            alert(errorMessage)\n          }\n          console.log(error)\n        })\n    }\n  }\n}\n</script>\n"]}]}