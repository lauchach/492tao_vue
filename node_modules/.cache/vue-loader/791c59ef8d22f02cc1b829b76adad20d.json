{"remainingRequest":"/Users/lauchach/CPE492web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lauchach/CPE492web/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lauchach/CPE492web/src/components/Login.vue","mtime":1631438027218},{"path":"/Users/lauchach/CPE492web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lauchach/CPE492web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lauchach/CPE492web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lauchach/CPE492web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lauchach/CPE492web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZiIH0gZnJvbSAnLi4vZmlyZWJhc2UnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTG9naW4nLAogIHByb3BzOiB7CiAgICBtc2c6IFN0cmluZwogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiAnJywKICAgICAgZW1haWw6ICcnLAogICAgICBwYXNzd29yZDogJycKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxvZ2luICgpIHsKICAgICAgY29uc29sZS5sb2coJ2F1dGggcGFzcycpCiAgICAgIGxldCBfZGF0YSA9IHt9CiAgICAgIGZiLmF1dGgoKS5zaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCh0aGlzLmVtYWlsLCB0aGlzLnBhc3N3b3JkKQogICAgICAgIC50aGVuKChlbWFpbCkgPT4gewogICAgICAgICAgY29uc3QgZGIgPSBmYi5maXJlc3RvcmUoKQogICAgICAgICAgZGIuY29sbGVjdGlvbignTUVNQkVSX1RBQkxFJykud2hlcmUoJ3N0dWRlbnRfbWFpbCcsICc9PScsIHRoaXMuZW1haWwpLmdldCgpLnRoZW4odXNlclNob3cgPT4gewogICAgICAgICAgICB1c2VyU2hvdy5mb3JFYWNoKGRvYyA9PiB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZG9jLmlkLCAnPT4nLCBkb2MuZGF0YSgpKQogICAgICAgICAgICAgIF9kYXRhID0gZG9jLmRhdGEoKQogICAgICAgICAgICB9KQogICAgICAgICAgICBjb25zb2xlLmxvZygnX2RhdGEgJywgX2RhdGEpCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyRGF0YScsIEpTT04uc3RyaW5naWZ5KF9kYXRhKSkKICAgICAgICAgICAgbGV0IHJlcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJEYXRhJykpCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgJywgcmVzKQogICAgICAgICAgICBpZiAocmVzLnR5cGUpIHsKICAgICAgICAgICAgICBpZiAocmVzLnR5cGUgPT09ICdBRE1JTicpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCdhZG1pbicpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMudHlwZSA9PT0gJ3VzZXInKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnUHJvZmlsZXZpZXdzJykKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgYWxlcnQoJ+C4oeC4o+C4muC4suC4h+C4reC4ouC5iOC4suC4h+C4nOC4tOC4lOC4nuC4peC4suC4lCDguIHguKPguLjguJPguLLguKXguK3guIfguYPguKvguKHguYjguK3guLXguIHguITguKPguLHguYnguIcnKQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgLy8gSGFuZGxlIEVycm9ycyBoZXJlLgogICAgICAgICAgdmFyIGVycm9yQ29kZSA9IGVycm9yLmNvZGUKICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlCiAgICAgICAgICBpZiAoZXJyb3JDb2RlID09PSAnYXV0aC93cm9uZy1wYXNzd29yZCcpIHsKICAgICAgICAgICAgYWxlcnQoJ1dyb25nIHBhc3N3b3JkLicpCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGVydChlcnJvck1lc3NhZ2UpCiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICB9KQogICAgfSwKICAgIHJlZ2lzdGVyICgpIHsKICAgICAgZmIuYXV0aCgpLmNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCh0aGlzLmVtYWlsLCB0aGlzLnBhc3N3b3JkKQogICAgICAgIC50aGVuKChlbWFpbCkgPT4gewogICAgICAgICAgY29uc3QgZGIgPSBmYi5maXJlc3RvcmUoKQogICAgICAgICAgZGIuY29sbGVjdGlvbignTUVNQkVSX1RBQkxFJykuZG9jKHRoaXMuZW1haWwpLnNldCh7CiAgICAgICAgICAgIHN0dWRlbnRfbWFpbDogdGhpcy5lbWFpbCwKICAgICAgICAgICAgdHlwZTogJ3VzZXInLAogICAgICAgICAgICBzdGF0dXM6IDAKICAgICAgICAgIH0pCiAgICAgICAgICBjb25zb2xlLmxvZygn4LiX4LizYWRkIGRiJykKICAgICAgICAgIGFsZXJ0KCfguKrguLPguYDguKPguYfguIgnKQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIC8vIEhhbmRsZSBFcnJvcnMgaGVyZS4KICAgICAgICAgIHZhciBlcnJvckNvZGUgPSBlcnJvci5jb2RlCiAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZQogICAgICAgICAgaWYgKGVycm9yQ29kZSA9PT0gJ2F1dGgvd2Vhay1wYXNzd29yZCcpIHsKICAgICAgICAgICAgYWxlcnQoJ1RoZSBwYXNzd29yZCBpcyB0b28gd2Vhay4nKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJyb3JNZXNzYWdlKQogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"login\">\n        <!-- Modal -->\n        <div class=\"modal fade\" id=\"login\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"loginTitle\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-dialog-centered\"  role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-body\">\n                        <ul class=\"nav nav-fill nav-pills mb-5\" id=\"pills-tab\" role=\"tablist\">\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link active\" id=\"pills-home-tab\" data-toggle=\"pill\" href=\"#pills-login\" role=\"tab\" aria-controls=\"pills-login\" aria-selected=\"true\">Login</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" id=\"pills-register-tab\" data-toggle=\"pill\" href=\"#pills-register\" role=\"tab\" aria-controls=\"pills-register\" aria-selected=\"false\">Signup</a>\n                            </li>\n                        </ul>\n                        <div class=\"tab-content\" id=\"pills-tabContent\">\n                        <div class=\"tab-pane fade show active\" id=\"pills-login\" role=\"tabpanel\" aria-labelledby=\"pills-login-tab\">\n                            <h5 class=\"text-center\">Login Please</h5>\n                            <div class=\"form-group\">\n                                <label for=\"exampleInputEmail1\">Email address</label>\n                                <input type=\"email\" v-model=\"email\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\">\n                                <small class=\"form-text text-muted\">We'll never share your email with anyone else.</small>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"exampleInputPassword1\">Password</label>\n                                <input type=\"password\" @keyup.enter=\"login\" v-model=\"password\" class=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Password\">\n                            </div>\n                            <div class=\"form-group\">\n                                <button class=\"btn btn-primary\" data-dismiss=\"modal\" @click=\"login\">Login</button>\n                            </div>\n                        </div>\n                        <div class=\"tab-pane fade\" id=\"pills-register\" role=\"tabpanel\" aria-labelledby=\"pills-register-tab\">\n                             <h5 class=\"text-center\">Create New Account</h5>\n                            <div class=\"form-group\">\n                                <label for=\"email\">Email address</label>\n                                <input type=\"email\"  v-model=\"email\" class=\"form-control\" id=\"email\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"password\">Password</label>\n                                <input type=\"password\" v-model=\"password\" class=\"form-control\" id=\"password\" placeholder=\"Password\">\n                            </div>\n                            <div class=\"form-group\">\n                                <button class=\"btn btn-primary\" data-dismiss=\"modal\"  @click=\"register\">Signup</button>\n                            </div>\n                        </div>\n                        </div>\n                </div>\n            </div>\n        </div>\n        </div>\n  </div>\n</template>\n<script>\nimport { fb } from '../firebase'\nexport default {\n  name: 'Login',\n  props: {\n    msg: String\n  },\n  data () {\n    return {\n      name: '',\n      email: '',\n      password: ''\n    }\n  },\n  methods: {\n    login () {\n      console.log('auth pass')\n      let _data = {}\n      fb.auth().signInWithEmailAndPassword(this.email, this.password)\n        .then((email) => {\n          const db = fb.firestore()\n          db.collection('MEMBER_TABLE').where('student_mail', '==', this.email).get().then(userShow => {\n            userShow.forEach(doc => {\n              console.log(doc.id, '=>', doc.data())\n              _data = doc.data()\n            })\n            console.log('_data ', _data)\n            localStorage.setItem('userData', JSON.stringify(_data))\n            let res = JSON.parse(localStorage.getItem('userData'))\n            console.log('res ', res)\n            if (res.type) {\n              if (res.type === 'ADMIN') {\n                this.$router.replace('admin')\n              } else if (res.type === 'user') {\n                this.$router.replace('Profileviews')\n              }\n            } else {\n              alert('มรบางอย่างผิดพลาด กรุณาลองใหม่อีกครั้ง')\n            }\n          })\n        })\n        .catch(function (error) {\n          // Handle Errors here.\n          var errorCode = error.code\n          var errorMessage = error.message\n          if (errorCode === 'auth/wrong-password') {\n            alert('Wrong password.')\n          } else {\n            alert(errorMessage)\n          }\n          console.log(error)\n        })\n    },\n    register () {\n      fb.auth().createUserWithEmailAndPassword(this.email, this.password)\n        .then((email) => {\n          const db = fb.firestore()\n          db.collection('MEMBER_TABLE').doc(this.email).set({\n            student_mail: this.email,\n            type: 'user',\n            status: 0\n          })\n          console.log('ทำadd db')\n          alert('สำเร็จ')\n        })\n        .catch(function (error) {\n        // Handle Errors here.\n          var errorCode = error.code\n          var errorMessage = error.message\n          if (errorCode === 'auth/weak-password') {\n            alert('The password is too weak.')\n          } else {\n            alert(errorMessage)\n          }\n          console.log(error)\n        })\n    }\n  }\n}\n</script>\n"]}]}